<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="generator" content="Crystal Docs 0.36.1">
<meta name="crystal_docs.project_version" content="0.2.0">
<meta name="crystal_docs.project_name" content="for">



<link href="css/style.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="js/doc.js"></script>

  <meta name="repository-name" content="for">
  <title>for 0.2.0</title>
  <script type="text/javascript">
  CrystalDocs.base_path = "";
  </script>
</head>
<body>

<svg class="hidden">
  <symbol id="octicon-link" viewBox="0 0 16 16">
    <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
  </symbol>
</svg>
<div class="sidebar">
  <div class="sidebar-header">
    <div class="search-box">
      <input type="search" class="search-input" placeholder="Search..." spellcheck="false" aria-label="Search">
    </div>

    <div class="project-summary">
      <h1 class="project-name">
        <a href="index.html">
          for
        </a>
      </h1>

      <span class="project-version">
        0.2.0
      </span>
    </div>
  </div>

  <div class="search-results hidden">
    <ul class="search-list"></ul>
  </div>

  <div class="types-list">
    <ul>
  
  <li class=" " data-id="for/toplevel" data-name="top level namespace">
      <a href="toplevel.html">Top Level Namespace</a>
      
    </li>
  
  <li class=" " data-id="for/For" data-name="for">
      <a href="For.html">For</a>
      
    </li>
  
</ul>

  </div>
</div>


<div class="main-content">
<p><img src="https://img.shields.io/github/workflow/status/wyhaines/for.cr/for.cr%20CI?style=for-the-badge&logo=GitHub" alt="for.cr CI"/>
<a href="https://github.com/wyhaines/for.cr/releases"><img src="https://img.shields.io/github/release/wyhaines/for.cr.svg?style=for-the-badge" alt="GitHub release"/></a>
<img src="https://img.shields.io/github/commits-since/wyhaines/for.cr/latest?style=for-the-badge" alt="GitHub commits since latest release (by SemVer)"/></p>

<h1><a id="for" class="anchor" href="#for">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>for</h1>

<p>This little shard implements a couple macros for additional for-loop-like looping constructs.</p>

<p>It implements a simple declarative style for-like iteration loop called <code><a href="toplevel.html#iterate(*elements,&blk)-macro">iterate</a></code>, which traverses all of the elements of a collection, passing each in turn to the provided block. It also implements a C-style <code><a href="toplevel.html#for(init=&quot;&quot;,test=&quot;&quot;,update=&quot;&quot;,run=true,&blk)-macro">for</a></code> looping construct, which can be assigned to a variable for execution later (or for repeated execution), with <em>initialization</em>, <em>test</em>, and <em>update</em> code lines, and a body that runs as a closure with its own lexical scope.</p>

<h2><a id="installation" class="anchor" href="#installation">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Installation</h2>

<ol><li>Add the dependency to your <code>shard.yml</code>:</li></ol>

<p><code></code>`yaml
   dependencies:</p>

<pre><code class="language-crystal"> for:
   github: wyhaines/for.cr</code></pre>

<p><code></code>`</p>

<ol><li>Run <code>shards install</code></li></ol>

<h2><a id="usage" class="anchor" href="#usage">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Usage</h2>

<pre><code class="language-crystal"><span class="k">require</span> <span class="s">&quot;for&quot;</span></code></pre>

<p>This defines four macros at the top level.</p>

<h3><a id="using" class="anchor" href="#using">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>using</h3>

<p>The first is <code>using TARGET</code>, which is a syntactic sugar macro. <code>using foo</code> results in inserting <code>foo</code> where it is executed.</p>

<p>This means that the following are equivalent:</p>

<pre><code class="language-crystal"><span class="k">for</span>(count, ary) { puts count }

<span class="k">for</span>(count, using ary) { puts count }</code></pre>

<p>And the following is acceptable syntax:</p>

<pre><code class="language-crystal">ary <span class="o">=</span> (<span class="n">1</span>..<span class="n">10</span>).to_a

pp using ary</code></pre>

<h3><a id="iterate" class="anchor" href="#iterate">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>iterate</h3>

<p>The second is a <em>for</em> style loop, called <em>iterate</em>, that iterates over all of the members of a collection.</p>

<pre><code class="language-crystal">ary <span class="o">=</span> [<span class="n">1</span>, <span class="n">2</span>, <span class="n">3</span>]

iterate(num, using ary) { puts num }

<span class="c"># This is the same as:</span>

ary.each { <span class="o">|</span>num<span class="o">|</span> puts num }</code></pre>

<p>This works with any collection that has an <code>#each</code> method.</p>

<h3><a id="for" class="anchor" href="#for">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>for</h3>

<p>The third structure is a C-style <em>for</em> loop.</p>

<p><em>for(<em>initialization</em>, <em>test</em>, <em>update</em>) { # block contents to iterate on }</em></p>

<p>The <em>initialization</em>, *test, and <em>update</em> items are code that will be evaluated
during the execution of the loop. The code should be provided as either a <em>String</em>
or a <em>Proc(Nil, Nil)</em>.</p>

<p>The <em>initialization</em> code gets executed a single time, before the loop starts, and
can be used to setup any state that is required before the loop runs.</p>

<p>The <em>test</em> code will be evaluated at the start of each iteration. If it evaluates to
<em>false</em>, then the loop body will execute. If it evaluates to <em>true</em> then the loop
exits immediately.</p>

<p>The <em>update</em> code executes after the loop body, and can be used to change counters
or other state that the <em>test</em> code may depend on to determine if the loop has finished
execution.</p>

<p>This structure could be legitimately useful. The loop so created is a closure, and
can be captured in a variable.</p>

<pre><code class="language-crystal"><span class="c"># Specify code with strings.</span>
<span class="k">for</span>(<span class="s">%(t = 0)</span>, <span class="s">%( t &lt; 10)</span>, <span class="s">%(t += 1)</span>) <span class="k">do</span>
  <span class="c"># Do Stuff</span>
<span class="k">end</span></code></pre>

<pre><code class="language-crystal"><span class="c"># Specify code with procs, and leverage the fact that it is a closure.</span>
t <span class="o">=</span> <span class="k">uninitialized</span> <span class="t">Int32</span>
<span class="k">for</span>(->{ t <span class="o">=</span> <span class="n">0</span> }, ->{ t <span class="o">&lt;</span> <span class="n">10</span> }, ->{ t += <span class="n">1</span> }) <span class="k">do</span>
  <span class="c"># Do Stuff</span>
<span class="k">end</span>
puts t
<span class="c"># =&gt; 10</span></code></pre>

<pre><code class="language-crystal"><span class="c"># The *for* loop can be assigned to a variable and called later.</span>
ary <span class="o">=</span> (<span class="n">1</span>..<span class="n">10</span>).to_a

t <span class="o">=</span> <span class="k">uninitialized</span> <span class="t">Int32</span>
transform <span class="o">=</span> <span class="k">for</span>(->{ t <span class="o">=</span> <span class="n">0</span> }, ->{ t <span class="o">&lt;</span> <span class="n">10</span> }, ->{ t += <span class="n">1</span> }, run: <span class="n">false</span>) { ary[t] <span class="o">=</span> ary[t] <span class="o">*</span> ary[t] }

<span class="c"># Do some stuff here...</span>

transform.call

pp ary
<span class="c"># =&gt; [1, 4, 9, 16, 25, 36, 49, 64, 81, 100]</span></code></pre>

<h3><a id="do-until" class="anchor" href="#do-until">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>do_until</h3>

<p>The <code><a href="toplevel.html#do_until(init=&quot;&quot;,test=&quot;&quot;,update=&quot;&quot;,run=true,&blk)-macro">do_until</a></code> loop is like the <code><a href="toplevel.html#for(init=&quot;&quot;,test=&quot;&quot;,update=&quot;&quot;,run=true,&blk)-macro">for</a></code> loop, except that it is an exit-controlled loop. This means that the condition to test for exiting the loop is checked at the end of the loop body instead of at the beginning of the loop body. This guarantees that the loop body will execute at least one time. Additionally, the loop will be exited <em>when</em> the condition is true.</p>

<p>Thus, it is functionally the opposite of a <em>for</em> loop.</p>

<pre><code class="language-crystal">t <span class="o">=</span> <span class="k">uninitialized</span> <span class="t">Int32</span>
do_until(->(){ t <span class="o">=</span> <span class="n">1</span> }, ->(){ t <span class="o">&gt;</span> <span class="n">0</span> }, ->{ t += <span class="n">1</span>}) {puts t}

<span class="c"># =&gt; 1</span>

puts t

<span class="c"># =&gt; 2</span>
</code></pre>

<h2><a id="contributing" class="anchor" href="#contributing">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Contributing</h2>

<ol><li>Fork it (&lt;https://github.com/wyhaines/for.cr/fork>)</li><li>Create your feature branch (<code>git checkout -b my-new-feature</code>)</li><li>Commit your changes (<code>git commit -am 'Add some feature'</code>)</li><li>Push to the branch (<code>git push origin my-new-feature</code>)</li><li>Create a new Pull Request</li></ol>

<h2><a id="contributors" class="anchor" href="#contributors">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Contributors</h2>

<ul><li><a href="https://github.com/wyhaines">Kirk Haines</a> - creator and maintainer</li></ul>

<p><img src="https://img.shields.io/github/languages/code-size/wyhaines/for.cr?style=for-the-badge" alt="GitHub code size in bytes"/>
<img src="https://img.shields.io/github/issues/wyhaines/for.cr?style=for-the-badge" alt="GitHub issues"/></p>
</div>
</body>
</html>
